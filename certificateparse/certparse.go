package certificateparse

import (
	"crypto/x509"
	"encoding/pem"
	"fmt"
	"strings"
)

func ParseCert() {
	parseCertContent()
}

func parseCertContent() {
	certContent := `-----BEGIN CERTIFICATE-----
MIIFQTCCBCmgAwIBAgISBJ+WvXumRgqHrG8dZrj4KE+9MA0GCSqGSIb3DQEBCwUA
MDIxCzAJBgNVBAYTAlVTMRYwFAYDVQQKEw1MZXQncyBFbmNyeXB0MQswCQYDVQQD
EwJSMzAeFw0yMTA0MDkxNDIwNDFaFw0yMTA3MDgxNDIwNDFaMCgxJjAkBgNVBAMT
HWdpY3VzdG9tY2VydHRlc3QuZ3RyaXZlZGkueHl6MIIBIjANBgkqhkiG9w0BAQEF
AAOCAQ8AMIIBCgKCAQEAtBt2PkZeBcpdSLNXiIlEjb9GTBfqzosYArZmbTQILuGW
LpL2XEjb4WKRJsAVVCDLaR11MHd4boioxA+XowRomNkECSLtR26qA3LrVpwoAas1
K1Vc8l/giAtoi5JONVBoBuF2UXDt1v9F4yS/ktv50Bb/x81GWNDhCfX8x+gL0+Bx
0hJmMPzIwv//IotyQlXn1JT0rjfVC3aOc19dznmXnJsX01XTIlIKsO/6a6CgzHwt
r9A5me7z5JiPlIX/E5JAhUF0lsk3BlxSKPoJN52LUVa/Qd5uov1DzXDBPu9hGskC
cbEQXC3Kftnp9hFs2KzaSL2ZuBgusSfCiaGxWF66cQIDAQABo4ICWTCCAlUwDgYD
VR0PAQH/BAQDAgWgMB0GA1UdJQQWMBQGCCsGAQUFBwMBBggrBgEFBQcDAjAMBgNV
HRMBAf8EAjAAMB0GA1UdDgQWBBQVzcZoG8X0viPPRd2msYATTeSaYTAfBgNVHSME
GDAWgBQULrMXt1hWy65QCUDmH6+dixTCxjBVBggrBgEFBQcBAQRJMEcwIQYIKwYB
BQUHMAGGFWh0dHA6Ly9yMy5vLmxlbmNyLm9yZzAiBggrBgEFBQcwAoYWaHR0cDov
L3IzLmkubGVuY3Iub3JnLzAoBgNVHREEITAfgh1naWN1c3RvbWNlcnR0ZXN0Lmd0
cml2ZWRpLnh5ejBMBgNVHSAERTBDMAgGBmeBDAECATA3BgsrBgEEAYLfEwEBATAo
MCYGCCsGAQUFBwIBFhpodHRwOi8vY3BzLmxldHNlbmNyeXB0Lm9yZzCCAQUGCisG
AQQB1nkCBAIEgfYEgfMA8QB2AFzcQ5L+5qtFRLFemtRW5hA3+9X6R9yhc5SyXub2
xw7KAAABeLc4lQMAAAQDAEcwRQIhAKEtE9psz0nW2HBks+v4iN02kMeYDirUsS4A
TIp1IMryAiACwdsC5zUAfzS7j/DL2tA18J5Ax+R3LhI6WvTnJMAFkwB3APZclC/R
dzAiFFQYCDCUVo7jTRMZM7/fDC8gC8xO8WTjAAABeLc4lOkAAAQDAEgwRgIhAIV6
uCiB7cCqCRryuThmBC1A6ku/rTcUMMsb8I65ag5dAiEAkKD+Un8g9uuFQne3oz6U
/LkvBUd7DgtblnOVWN5J3fUwDQYJKoZIhvcNAQELBQADggEBAHm2lODJk6oodFBG
JLzr7EREauQ9DyPPpcit3qGIC3ls7XXPYjQuX4rp/ib8x0bkK+/8pqr3iT4+7qMC
ISS4xw7/RVnnJgN1uCTQxnCLr0X/B8iFRCjQD1BKopSKdoQ98bZ0fdIWwh/NpSwY
8/2c40LVyfwm7fnWBxXGQeneeRJ17G1sLrzS54TnePyxzNm8cPxpN/df7WKqLvoC
MUOa+K3LWw4JOwEH0Ghvm0yFsaXtPM0cc/3Porsga0nufv/y5nT5rn6CbclQMajp
m3CokyfX3+z97abRsRmjFuoFuRI1swyGZW31eY6kMSHTtPEI1684o22pTHEqAMxa
lHd+fzc=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIEZTCCA02gAwIBAgIQQAF1BIMUpMghjISpDBbN3zANBgkqhkiG9w0BAQsFADA/
MSQwIgYDVQQKExtEaWdpdGFsIFNpZ25hdHVyZSBUcnVzdCBDby4xFzAVBgNVBAMT
DkRTVCBSb290IENBIFgzMB4XDTIwMTAwNzE5MjE0MFoXDTIxMDkyOTE5MjE0MFow
MjELMAkGA1UEBhMCVVMxFjAUBgNVBAoTDUxldCdzIEVuY3J5cHQxCzAJBgNVBAMT
AlIzMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAuwIVKMz2oJTTDxLs
jVWSw/iC8ZmmekKIp10mqrUrucVMsa+Oa/l1yKPXD0eUFFU1V4yeqKI5GfWCPEKp
Tm71O8Mu243AsFzzWTjn7c9p8FoLG77AlCQlh/o3cbMT5xys4Zvv2+Q7RVJFlqnB
U840yFLuta7tj95gcOKlVKu2bQ6XpUA0ayvTvGbrZjR8+muLj1cpmfgwF126cm/7
gcWt0oZYPRfH5wm78Sv3htzB2nFd1EbjzK0lwYi8YGd1ZrPxGPeiXOZT/zqItkel
/xMY6pgJdz+dU/nPAeX1pnAXFK9jpP+Zs5Od3FOnBv5IhR2haa4ldbsTzFID9e1R
oYvbFQIDAQABo4IBaDCCAWQwEgYDVR0TAQH/BAgwBgEB/wIBADAOBgNVHQ8BAf8E
BAMCAYYwSwYIKwYBBQUHAQEEPzA9MDsGCCsGAQUFBzAChi9odHRwOi8vYXBwcy5p
ZGVudHJ1c3QuY29tL3Jvb3RzL2RzdHJvb3RjYXgzLnA3YzAfBgNVHSMEGDAWgBTE
p7Gkeyxx+tvhS5B1/8QVYIWJEDBUBgNVHSAETTBLMAgGBmeBDAECATA/BgsrBgEE
AYLfEwEBATAwMC4GCCsGAQUFBwIBFiJodHRwOi8vY3BzLnJvb3QteDEubGV0c2Vu
Y3J5cHQub3JnMDwGA1UdHwQ1MDMwMaAvoC2GK2h0dHA6Ly9jcmwuaWRlbnRydXN0
LmNvbS9EU1RST09UQ0FYM0NSTC5jcmwwHQYDVR0OBBYEFBQusxe3WFbLrlAJQOYf
r52LFMLGMB0GA1UdJQQWMBQGCCsGAQUFBwMBBggrBgEFBQcDAjANBgkqhkiG9w0B
AQsFAAOCAQEA2UzgyfWEiDcx27sT4rP8i2tiEmxYt0l+PAK3qB8oYevO4C5z70kH
ejWEHx2taPDY/laBL21/WKZuNTYQHHPD5b1tXgHXbnL7KqC401dk5VvCadTQsvd8
S8MXjohyc9z9/G2948kLjmE6Flh9dDYrVYA9x2O+hEPGOaEOa1eePynBgPayvUfL
qjBstzLhWVQLGAkXXmNs+5ZnPBxzDJOLxhF2JIbeQAcH5H0tZrUlo5ZYyOqA7s9p
O5b85o3AM/OJ+CktFBQtfvBhcJVd9wvlwPsk+uyOy2HI7mNxKKgsBTt375teA2Tw
UdHkhVNcsAKX1H7GNNLOEADksd86wuoXvg==
-----END CERTIFICATE-----`

	block, _ := pem.Decode([]byte(certContent))
	if block == nil {
		panic("failed to parse certificate PEM")
	}
	cert, err := x509.ParseCertificate(block.Bytes)
	if err != nil {
		panic("failed to parse certificate: " + err.Error())
	}
	printCertInfo(cert)

	certContent1 := `-----BEGIN CERTIFICATE-----
MIIFLTCCBBWgAwIBAgISBBpliytrKsMXHYheqvfKYFacMA0GCSqGSIb3DQEBCwUA
MDIxCzAJBgNVBAYTAlVTMRYwFAYDVQQKEw1MZXQncyBFbmNyeXB0MQswCQYDVQQD
EwJSMzAeFw0yMTA0MTYxNjA1MjlaFw0yMTA3MTUxNjA1MjlaMB4xHDAaBgNVBAMM
Eyoud3B0ZXN0aW5zdGFsbC5jb20wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEK
AoIBAQDeDTHu+p69oawVoH0m/RKARot317/RtsQkYHiSG746eYcX99KeNrZMhg/e
em03QwaVirwgbFJdY6wkX1/bTx0Z68vQLmwdXUD+zyHU5sH/JPHhUtP2CjkqEPdj
I3tXdYgnQJyPD/O/eJXr5j8bt2EWyIcRzXLZWgUWhwpw63Gl5G7TTKpgf1KfgRH8
o1K5W4p/cs/y1xi128wPn9Ra5kgX2ZfIBAhUU0ChxF46yY05l6Ek2cmW7li7pcfw
/S7JUav0tVNhiz9vDLHDnKfrF524nUfNE/KVw11nzY/sixE53CUk5I4tjB9WD8lh
rihi5YZ21vNYeeVZWsmX1bOsuza1AgMBAAGjggJPMIICSzAOBgNVHQ8BAf8EBAMC
BaAwHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMAwGA1UdEwEB/wQCMAAw
HQYDVR0OBBYEFAL1X9Uq/G6WzlOwbdH2lc7h17GTMB8GA1UdIwQYMBaAFBQusxe3
WFbLrlAJQOYfr52LFMLGMFUGCCsGAQUFBwEBBEkwRzAhBggrBgEFBQcwAYYVaHR0
cDovL3IzLm8ubGVuY3Iub3JnMCIGCCsGAQUFBzAChhZodHRwOi8vcjMuaS5sZW5j
ci5vcmcvMB4GA1UdEQQXMBWCEyoud3B0ZXN0aW5zdGFsbC5jb20wTAYDVR0gBEUw
QzAIBgZngQwBAgEwNwYLKwYBBAGC3xMBAQEwKDAmBggrBgEFBQcCARYaaHR0cDov
L2Nwcy5sZXRzZW5jcnlwdC5vcmcwggEFBgorBgEEAdZ5AgQCBIH2BIHzAPEAdwBE
lGUusO7Or8RAB9io/ijA2uaCvtjLMbU/0zOWtbaBqAAAAXjbpQmfAAAEAwBIMEYC
IQCCK0uqDFKMqeZbzpKpqa/XAwGZk/+Uf1hwMhCSe9X7iwIhAIk4AIRR09flSTck
NgpMKs8rlX4I9kXyT/YQwXmwjKTfAHYA9lyUL9F3MCIUVBgIMJRWjuNNExkzv98M
LyALzE7xZOMAAAF426UJhgAABAMARzBFAiB+Yd3v32lMohsF3qOYbmbRH06V+O49
2Bc6Vx6wfjpAnwIhAJhtinhbwWjULaGcO1K7jMpy74xV+rEK3MH8r4n8nE4FMA0G
CSqGSIb3DQEBCwUAA4IBAQC6yMggTM98o1nvJloHar3xwbwmgptjUigzpP66ke3/
iGH22Ukp2CBX+CdGww/jcQJ9Jng44krVj+Tf1dV2PofmNHJn1tfbBbORGqRebJTt
yQYkrNlBtfbI0tiANjJtvasGh8yA0XZdYrBy5ZqyFiPR81GhlAHmCdHJRxQQf8+f
/T4/uBdmcSktDTrpPnMdjd/NM03S3B+vzfE36+8AeeORQWBCYCce4SCJXOZVBmQl
e18w9aAopLrKSP4Rue8pVxwqZYmhkK+qJaEu1e6nTWAJWpK7Nqu/UzsusGiLpP8m
2e8O9fKsdZ6VFPIUBwnH6Or5Ilyc7+RqMmlcbFyT7/Zw
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIEZTCCA02gAwIBAgIQQAF1BIMUpMghjISpDBbN3zANBgkqhkiG9w0BAQsFADA/
MSQwIgYDVQQKExtEaWdpdGFsIFNpZ25hdHVyZSBUcnVzdCBDby4xFzAVBgNVBAMT
DkRTVCBSb290IENBIFgzMB4XDTIwMTAwNzE5MjE0MFoXDTIxMDkyOTE5MjE0MFow
MjELMAkGA1UEBhMCVVMxFjAUBgNVBAoTDUxldCdzIEVuY3J5cHQxCzAJBgNVBAMT
AlIzMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAuwIVKMz2oJTTDxLs
jVWSw/iC8ZmmekKIp10mqrUrucVMsa+Oa/l1yKPXD0eUFFU1V4yeqKI5GfWCPEKp
Tm71O8Mu243AsFzzWTjn7c9p8FoLG77AlCQlh/o3cbMT5xys4Zvv2+Q7RVJFlqnB
U840yFLuta7tj95gcOKlVKu2bQ6XpUA0ayvTvGbrZjR8+muLj1cpmfgwF126cm/7
gcWt0oZYPRfH5wm78Sv3htzB2nFd1EbjzK0lwYi8YGd1ZrPxGPeiXOZT/zqItkel
/xMY6pgJdz+dU/nPAeX1pnAXFK9jpP+Zs5Od3FOnBv5IhR2haa4ldbsTzFID9e1R
oYvbFQIDAQABo4IBaDCCAWQwEgYDVR0TAQH/BAgwBgEB/wIBADAOBgNVHQ8BAf8E
BAMCAYYwSwYIKwYBBQUHAQEEPzA9MDsGCCsGAQUFBzAChi9odHRwOi8vYXBwcy5p
ZGVudHJ1c3QuY29tL3Jvb3RzL2RzdHJvb3RjYXgzLnA3YzAfBgNVHSMEGDAWgBTE
p7Gkeyxx+tvhS5B1/8QVYIWJEDBUBgNVHSAETTBLMAgGBmeBDAECATA/BgsrBgEE
AYLfEwEBATAwMC4GCCsGAQUFBwIBFiJodHRwOi8vY3BzLnJvb3QteDEubGV0c2Vu
Y3J5cHQub3JnMDwGA1UdHwQ1MDMwMaAvoC2GK2h0dHA6Ly9jcmwuaWRlbnRydXN0
LmNvbS9EU1RST09UQ0FYM0NSTC5jcmwwHQYDVR0OBBYEFBQusxe3WFbLrlAJQOYf
r52LFMLGMB0GA1UdJQQWMBQGCCsGAQUFBwMBBggrBgEFBQcDAjANBgkqhkiG9w0B
AQsFAAOCAQEA2UzgyfWEiDcx27sT4rP8i2tiEmxYt0l+PAK3qB8oYevO4C5z70kH
ejWEHx2taPDY/laBL21/WKZuNTYQHHPD5b1tXgHXbnL7KqC401dk5VvCadTQsvd8
S8MXjohyc9z9/G2948kLjmE6Flh9dDYrVYA9x2O+hEPGOaEOa1eePynBgPayvUfL
qjBstzLhWVQLGAkXXmNs+5ZnPBxzDJOLxhF2JIbeQAcH5H0tZrUlo5ZYyOqA7s9p
O5b85o3AM/OJ+CktFBQtfvBhcJVd9wvlwPsk+uyOy2HI7mNxKKgsBTt375teA2Tw
UdHkhVNcsAKX1H7GNNLOEADksd86wuoXvg==
-----END CERTIFICATE-----`

	block1, _ := pem.Decode([]byte(certContent1))
	if block1 == nil {
		panic("failed to parse certificate PEM")
	}
	cert1, err1 := x509.ParseCertificate(block1.Bytes)
	if err1 != nil {
		panic("failed to parse certificate: " + err1.Error())
	}
	printCertInfo(cert1)

}

func printCertInfo(cert *x509.Certificate) {
	fmt.Println("cert.SerialNumber: ", cert.SerialNumber)
	fmt.Println("cert.Issuer: ", cert.Issuer)
	fmt.Println("cert.Subject: ", cert.Subject)
	fmt.Println("cert.Subject.CommonName: ", cert.Subject.CommonName)
	if strings.HasPrefix(cert.Subject.CommonName, "*.") {
		fmt.Println("cert.Subject.CommonName(Trimmed): ", strings.TrimLeft(cert.Subject.CommonName, "*."))
	}
	if strings.Index(cert.Subject.CommonName, "*.") == 0 {
		fmt.Println("cert.Subject.CommonName(Trimmed): ", strings.TrimLeft(cert.Subject.CommonName, "*."))
	}
}
